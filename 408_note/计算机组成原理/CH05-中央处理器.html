<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CH05-中央处理器 - 408详细内容</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../408_note/数据结构/0_408数据结构内容概览.html"><strong aria-hidden="true">1.</strong> 数据结构</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../408_note/数据结构/CH01-绪论.html"><strong aria-hidden="true">1.1.</strong> CH01-绪论</a></li><li class="chapter-item expanded "><a href="../../408_note/数据结构/CH02-线性表.html"><strong aria-hidden="true">1.2.</strong> CH02-线性表</a></li><li class="chapter-item expanded "><a href="../../408_note/数据结构/CH03-栈_队列_数组.html"><strong aria-hidden="true">1.3.</strong> CH03-栈_队列_数组</a></li><li class="chapter-item expanded "><a href="../../408_note/数据结构/CH04-串.html"><strong aria-hidden="true">1.4.</strong> CH04-串</a></li><li class="chapter-item expanded "><a href="../../408_note/数据结构/CH05-树与二叉树.html"><strong aria-hidden="true">1.5.</strong> CH05-树与二叉树</a></li><li class="chapter-item expanded "><a href="../../408_note/数据结构/CH06-图.html"><strong aria-hidden="true">1.6.</strong> CH06-图</a></li><li class="chapter-item expanded "><a href="../../408_note/数据结构/CH07-查找.html"><strong aria-hidden="true">1.7.</strong> CH07-查找</a></li><li class="chapter-item expanded "><a href="../../408_note/数据结构/CH08-排序.html"><strong aria-hidden="true">1.8.</strong> CH08-排序</a></li></ol></li><li class="chapter-item expanded "><a href="../../408_note/计算机组成原理/0_408组成原理概览.html"><strong aria-hidden="true">2.</strong> 计算机组成原理</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../408_note/计算机组成原理/CH01-计算机系统概述.html"><strong aria-hidden="true">2.1.</strong> CH01-计算机系统概述</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机组成原理/CH02-数据的表示和运算.html"><strong aria-hidden="true">2.2.</strong> CH02-数据的表示和运算</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机组成原理/CH03-存储器.html"><strong aria-hidden="true">2.3.</strong> CH03-存储器</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机组成原理/CH04-指令系统.html"><strong aria-hidden="true">2.4.</strong> CH04-指令系统</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机组成原理/CH05-中央处理器.html" class="active"><strong aria-hidden="true">2.5.</strong> CH05-中央处理器</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机组成原理/CH06-总线.html"><strong aria-hidden="true">2.6.</strong> CH06-总线</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机组成原理/CH07-IO系统.html"><strong aria-hidden="true">2.7.</strong> CH07-IO系统</a></li></ol></li><li class="chapter-item expanded "><a href="../../408_note/操作系统/0_408操作系统概览.html"><strong aria-hidden="true">3.</strong> 操作系统</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../408_note/操作系统/CH01-操作系统概述.html"><strong aria-hidden="true">3.1.</strong> CH01-操作系统概述</a></li><li class="chapter-item expanded "><a href="../../408_note/操作系统/CH02-进程管理.html"><strong aria-hidden="true">3.2.</strong> CH02-进程管理</a></li><li class="chapter-item expanded "><a href="../../408_note/操作系统/CH03-内存管理.html"><strong aria-hidden="true">3.3.</strong> CH03-内存管理</a></li><li class="chapter-item expanded "><a href="../../408_note/操作系统/CH04-文件管理.html"><strong aria-hidden="true">3.4.</strong> CH04-文件管理</a></li><li class="chapter-item expanded "><a href="../../408_note/操作系统/CH05-IO系统.html"><strong aria-hidden="true">3.5.</strong> CH05-IO系统</a></li></ol></li><li class="chapter-item expanded "><a href="../../408_note/计算机网络/0_408计算机网络概述.html"><strong aria-hidden="true">4.</strong> 计算机网络</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../408_note/计算机网络/CH01-计算机网络体系结构.html"><strong aria-hidden="true">4.1.</strong> CH01-计算机网络体系结构</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机网络/CH02-物理层.html"><strong aria-hidden="true">4.2.</strong> CH02-物理层</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机网络/CH03-链路层.html"><strong aria-hidden="true">4.3.</strong> CH03-链路层</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机网络/CH04-网络层.html"><strong aria-hidden="true">4.4.</strong> CH04-网络层</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机网络/CH05-运输层.html"><strong aria-hidden="true">4.5.</strong> CH05-运输层</a></li><li class="chapter-item expanded "><a href="../../408_note/计算机网络/CH06-应用层.html"><strong aria-hidden="true">4.6.</strong> CH06-应用层</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">408详细内容</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>数据通路容易考大题。</p>
<h2 id="cpu的功能和基本结构"><a class="header" href="#cpu的功能和基本结构">CPU的功能和基本结构</a></h2>
<h3 id="功能"><a class="header" href="#功能">功能</a></h3>
<p>CPU由<strong>运算器和控制器</strong>组成。控制器负责协调并控制计算机各部件执行程序的指令序列，包括取指令、分析指令、执行指令；运算器是对数据进行加工。</p>
<p>CPU的具体功能：</p>
<ul>
<li>指令控制：程序的顺序控制</li>
<li>操作控制：一条指令功能由若干操作信号的组合来实现。CPU管理并产生由内存取出的每条指令的操作信号，把操作信号送往相应部件</li>
<li>时间控制：为每条指令按时间顺序提供应用的控制信号</li>
<li>数据加工：对数据进行算术或逻辑运算</li>
<li>中断处理：对异常情况和特殊请求进行处理</li>
</ul>
<h3 id="基本结构"><a class="header" href="#基本结构">基本结构</a></h3>
<p><strong>运算器</strong></p>
<ul>
<li>算术逻辑单元ALU</li>
<li>暂存寄存器</li>
<li>累加寄存器ACC</li>
<li>通用寄存器组</li>
<li>程序状态字寄存器PSW</li>
<li>移位器</li>
<li>计数器</li>
</ul>
<p><strong>控制器</strong></p>
<ul>
<li>程序计数器PC：指出下一条指令在主存中的存放地址。PC有自增功能。</li>
<li>指令寄存器IR：用于保存当前正在执行的那条指令</li>
<li>指令译码器：仅对操作码字段进行译码，向控制器提供特定操作信号</li>
<li>存储器地址寄存器MAR</li>
<li>存储器数据寄存器MDR</li>
<li>时序系统：用于产生各种时序信号。由统一时钟CLOCK分频得到。</li>
<li>微操作信号发生器：根据IR和PSW的内容及时序信号，产生控制整个计算机系统所需的各种控制信号，结构有组合逻辑型和存储逻辑型。</li>
</ul>
<h2 id="指令执行过程"><a class="header" href="#指令执行过程">指令执行过程</a></h2>
<h3 id="指令周期"><a class="header" href="#指令周期">指令周期</a></h3>
<ul>
<li>指令周期：CPU从主存中取出并执行一条指令的时间</li>
<li>机器周期：不同的工作周期，例如取指、间址、执行、中断周期</li>
<li>时钟周期（节拍）：CPU操作的最基本单位</li>
</ul>
<p>每个指令周期内的机器周期数可以不相等；例如无条件转移指令JMP X在执行时不需要访问主存，只包含取址和执行阶段，所以其指令周期只包含取指和执行周期。</p>
<p>间址指令为了取操作数需要先访问一次主存，取出有效地址，然后访问主存，取出操作数，所以还需要包括间址周期。</p>
<p>当CPU采用中断方式实现主机和I/O设备的信息交换时，CPU在每条指令执行结束前都要发中断查询信号，若有中断请求则CPU进入中断响应阶段，又称中断周期。</p>
<h3 id="指令周期的数据流"><a class="header" href="#指令周期的数据流">指令周期的数据流</a></h3>
<p>（各周期的详细步骤见书上的图）</p>
<p>根据指令要求依次访问的数据序列。</p>
<p><strong>取指周期</strong></p>
<p>根据PC中的内容从主存中取出指令代码并存放在IR中。取指的同时，PC加1</p>
<p>数据流如下：</p>
<ul>
<li>PC$\to$MAR$\to$地址总线$\to$主存</li>
<li>CU发出读命令$\to$控制总线$\to$主存</li>
<li>主存$\to$数据总线$\to$MDR$\to$IR</li>
<li>CU发出控制指令$\to$PC内容加1</li>
</ul>
<p><strong>间址周期</strong></p>
<p>取操作数的有效地址。</p>
<p>数据流如下：</p>
<ul>
<li>Ad(IR)（或MDR）$\to$MAR$\to$地址总线$\to$主存</li>
<li>CU发出读命令$\to$控制总线$\to$主存</li>
<li>主存$\to$数据总线$\to$MDR（存放操作数有效地址）</li>
</ul>
<p>（Ad(IR)指的是存放在IR中的指令字的地址段）</p>
<p><strong>执行周期</strong></p>
<p>取操作数，并根据IR中指令字的操作码通过ALU操作产生执行结果。</p>
<p>不同指令的执行周期操作不同，没有统一的数据流向。</p>
<p><strong>中断周期</strong></p>
<p>处理中断请求。假设程序断点存入堆栈，并用SP指示栈顶指针，且进栈操作是先修改栈顶指针后存入数据，则数据流如下：</p>
<ul>
<li>CU控制将SP减1，SP$\to$MAR$\to$地址总线$\to$主存</li>
<li>CU发出写命令$\to$控制总线$\to$主存</li>
<li>PC$\to$MDR$\to$数据总线$\to$主存（程序断点存入主存）</li>
<li>CU（中断服务程序的入口地址）$\to$PC</li>
</ul>
<h3 id="指令执行方案"><a class="header" href="#指令执行方案">指令执行方案</a></h3>
<p><strong>单指令周期</strong></p>
<p>对所有指令选用<strong>相同的执行时间</strong>来完成，即每条指令都在固定的时间周期内完成，指令之间串行执行。</p>
<p>对于本可以在更短时间内完成的指令，要使用这个较长的周期来完成，会<strong>降低整个系统的运行速度</strong>。</p>
<p><strong>多指令周期</strong></p>
<p>对不同类型的指令选用不同的执行步骤来完成。指令之间串行执行。但可以选用<strong>不同个数的时钟周期</strong>来完成不同指令的执行过程，指令需要几个周期就分配几个周期。</p>
<p><strong>流水线方案</strong></p>
<p>指令之间可以并行执行，目标是力求在<strong>每个时钟脉冲</strong>周期完成一条指令的执行过程。这种方案通过在每个时钟周期启动一条指令，尽量让多条指令同时运行，但各自处于不同的执行步骤中。</p>
<h2 id="数据通路"><a class="header" href="#数据通路">数据通路</a></h2>
<h3 id="功能-1"><a class="header" href="#功能-1">功能</a></h3>
<p>数据在功能部件之间传输的路径称为数据通路。路径上的部件称为<strong>数据通路部件</strong>。数据通路描述了信息从什么地方开始，中间经过哪个寄存器或多路开关，最后传送到哪个寄存器，这些都需要加以控制。</p>
<p>数据通路由控制部件控制，控制部件根据每条指令功能的不同生成对数据通路的控制信号，并正确控制指令的执行流程。</p>
<h3 id="基本结构-1"><a class="header" href="#基本结构-1">基本结构</a></h3>
<ul>
<li>CPU内部单总线方式</li>
</ul>
<p>将所有寄存器的输入和输出端都连接到一条公共通路上，结构简单，但数据传输存在较多冲突，性能较低。</p>
<ul>
<li>CPU内部三总线方式</li>
</ul>
<p>将所有寄存器的输入和输出端都连接到多条公共通路上，能同时在多个总线上传输不同数据，提高效率。</p>
<ul>
<li>专用数据通路方式</li>
</ul>
<p>根据指令执行过程中的数据和地址的流动方向安排连接线路，避免使用共享的总线，性能较高但硬件量大。</p>
<p><strong>寄存器间的数据传送</strong></p>
<p>寄存器之间的数据传送可以通过CPU内部总线完成。</p>
<p>这里以PC寄存器为例：</p>
<p>PC$\rightarrow$Bus</p>
<p>Bus$\rightarrow$MAR</p>
<p><strong>主存与CPU之间的数据传送</strong></p>
<p>二者之间的数据传送同样也要借助CPU内部总线完成。</p>
<p>PC$\rightarrow$Bus$\rightarrow$MAR</p>
<p>1$\rightarrow$R（CU发出读命令）</p>
<p>MEM(MAR)$\rightarrow$MDR</p>
<p>MDR$\rightarrow$Bus$\rightarrow$IR</p>
<p><strong>执行算术或逻辑运算</strong></p>
<p>ALU内部本身没有存储功能，如果要执行加法运算，相加的两个数必须在ALU的两个输入端同时有效。</p>
<h2 id="控制器"><a class="header" href="#控制器">控制器</a></h2>
<h3 id="结构和功能"><a class="header" href="#结构和功能">结构和功能</a></h3>
<p>计算机硬件的主要连接关系：</p>
<ul>
<li>运算器通过数据总线与内存、输入设备、输出设备传送数据</li>
<li>输入输出设备与总线相连</li>
<li>内存、输入设备、输出设备通过地址总线接收地址信息，从控制总线得到控制信号，通过数据总线与其他部件传送数据。</li>
</ul>
<p>控制器的主要功能：</p>
<ul>
<li>从主存中取出一条指令，并指出下一条指令在内存中的位置</li>
<li>对指令进行译码或测试，并产生相应控制信号</li>
<li>指挥并控制CPU、主存、输入输出设备之间的数据流动</li>
</ul>
<p>根据控制器产生<strong>微操作控制信号</strong>的方式不同，控制器可以分为<strong>硬布线</strong>控制器和<strong>微程序</strong>控制器，两类控制器的PC和IR是相同的，但是确定和表示执行步骤的方法以及给出控制信号的方案不同。</p>
<h3 id="硬布线控制器"><a class="header" href="#硬布线控制器">硬布线控制器</a></h3>
<p>根据指令的要求、当前的时序以及外部和内部的状态，按时间的顺序发送一系列微操作控制信号。由复杂的组合逻辑门电路和一些触发器构成，又称为组合逻辑控制器。</p>
<p><strong>硬布线控制单元</strong></p>
<p>指令的操作码时决定控制单元发出不同操作命令（控制信号）的关键。为了简化控制单元CU的逻辑，将指令的操作码译码和节拍发生器从CU分离出来，得到简化的控制单元图。</p>
<p>CU的输入信号来源：</p>
<ul>
<li>经指令译码器译码产生的指令信息。</li>
<li>时序系统产生的机器周期信号和节拍信号。</li>
<li>来自执行单元的反馈信息，即标志。控制单元有时需要依赖CPU当前所处的状态产生控制信号。</li>
</ul>
<p>CU输出到CPU内部或外部控制总线上。</p>
<p><strong>时序系统及微操作</strong></p>
<ul>
<li>时钟周期：用时钟信号控制节拍发生器，产生节拍。每个节拍的宽度正好对应一个时钟周期。</li>
<li>机器周期：所有指令执行过程中过的一个基准时间。不同指令的操作不同，指令周期也不同。访问一次存储器的时间是固定的，因此童话参观以存取周期为基准时间，即内存中读取一个指令字的最短时间作为机器时间。在存储字长等于指令字长的前提下，取指周期也可视为机器周期。</li>
<li>指令周期。</li>
<li>微操作命令分析：</li>
</ul>
<p>执行程序过程中，对于不同指令，控制单元需要发出各种不同的微操作命令。一条指令分为3个工作周期：取指、间址、执行周期。下面分析各个子周期的微操作指令：</p>
<ol>
<li>
<p>取指周期</p>
</li>
<li>
<p>间址周期</p>
</li>
<li>
<p>执行周期</p>
<p>a. 非访存指令</p>
<p>b. 访存指令</p>
<p>c. 转移指令</p>
</li>
</ol>
<p><strong>CPU的控制方式</strong></p>
<p>控制单元控制一条指令执行的过程，实质上是依次执行一个确定的微操作序列的过程。主要有以下三种控制方式：</p>
<ul>
<li>同步控制：系统有一个统一的时钟，所有控制信号来自这个统一的时钟信号。采取完全统一的、具有相同时间间隔和相同数目的节拍作为机器周期来运行不同指令。控制电路简单但运行速度慢。</li>
<li>异步控制：不存在基准时标信号，各部件按照自身固有速度工作，通过应答方式联络。运行速度块但控制电路较为复杂。</li>
<li>联合控制：介于同步、异步之间的一种折中。对不同指令大部分采用同步控制，小部分采用异步控制。</li>
</ul>
<p><strong>硬布线控制单元涉及步骤</strong></p>
<ul>
<li>列出微操作命令的操作时间表</li>
<li>进行微操作信号综合，得到逻辑表达式</li>
<li>根据逻辑表达式画出微操作命令的逻辑图，并用逻辑门电路实现。</li>
</ul>
<h3 id="微程序控制器"><a class="header" href="#微程序控制器">微程序控制器</a></h3>
<p>微程序控制器采用存储逻辑实现，即把微操作信号<strong>代码化</strong>，使每条<strong>机器指令</strong>转化成一段<strong>微程序</strong>并存入一个<strong>专门的存储器（控制存储器CM）<strong>中。微操作控制信号由</strong>微指令</strong>（每个微程序包括若干微指令）产生。</p>
<p><strong>基本概念</strong></p>
<ul>
<li>
<p>微命令和微操作：一个微操作是计算机中最基本的、不可再分解的操作。一条微命令和微操作一一对应。微命令是构成控制序列的最小单位。</p>
</li>
<li>
<p>微指令和微周期：微指令是由若干微命令的集合。存放微指令的控制存储器的单元地址称为微地址。一条微指令包括两大部分信息：</p>
<ul>
<li>操作控制（微操作码）字段：产生某一步操作所需的各种操作控制信号</li>
<li>顺序控制（微地址码）字段：用于控制产生下一条要执行的微指令地址</li>
</ul>
<p>微周期指从控制存储器读取一条微指令并执行相应微操作所需的时间。</p>
</li>
<li>
<p>主存储器与控制存储器：主存在CPU外部，用于存放程序和数据，用RAM实现；控制存储器CM用于存放微程序，在CPU内部，由ROM实现</p>
</li>
<li>
<p>程序与微程序：微程序由微指令组成，用于描述机器指令，微程序实际上是机器指令的实时解释器，对用户透明。</p>
</li>
</ul>
<p><strong>组成和工作过程</strong></p>
<p>（1）微程序控制器的基本组成</p>
<ul>
<li>控制存储器：核心部件，用于存放微程序，由ROM构成</li>
<li>微指令寄存器CMDR：用于存放从CM中取出的微指令，位数同微指令字长相等</li>
<li>微地址形成部件：用于产生初始微地址和后继微地址，保证微指令的连续执行</li>
<li>微地址寄存器CMAR：接收微地址形成部件送来的微地址，为在CM中读取微指令做准备。</li>
</ul>
<p>（2）微程序的工作过程</p>
<ul>
<li>执行<strong>取微指令公共操作</strong>。在机器开始运行时，自动将取指微程序的入口地址送入CMAR，并从CM取出相应微指令送入CMDR</li>
<li>由机器指令的操作码字段通过微地址形成部件产生<strong>该机器指令对应的微程序的入口地址</strong>，送入CMAR</li>
<li>从CM中<strong>逐条取出对应微指令并执行</strong></li>
<li>执行完对应于一条机器指令的一个微程序后，又回到<strong>取指微程序</strong>的入口地址，继续第一步，完成下一条机器指令的公共操作</li>
</ul>
<p>（3）微程序和机器指令</p>
<p><strong>微指令的编码方式</strong></p>
<p>又称微指令的控制方式，指如何对微指令的控制字段进行编码，以形成控制信号。编码是为了在保证速度的情况下，尽量缩短指令字长。</p>
<ul>
<li>直接编码</li>
</ul>
<p>直接编码无须进行译码，微指令的微命令字段对应的每一位都代表一个微命令。每个微命令对应并控制数据通路中的一个微操作。</p>
<p>这种方式简单、直观、执行速度快，操作并行性好；缺点是微指令字长过长。</p>
<ul>
<li>字段直接编码</li>
</ul>
<p>将微指令的微命令字段分成若干小字段，把互斥性微命令组合在同一字段，相容性微命令组合在不同字段，每个字段独立编码。</p>
<ul>
<li>字段间接编码</li>
</ul>
<p>一个字段某些微命令需要另一个字段中的某些微命令来解释，不是直接靠字段直接译码发出的微命令，称为字段间接编码。这种方式可以进一步缩短微指令字长，但削弱了微指令的并行控制能力，通常作为一种辅助手段。</p>
<p><strong>微指令的地址形成方式</strong></p>
<p><strong>微指令的格式</strong></p>
<ul>
<li>水平型微指令</li>
<li>垂直型微指令</li>
<li>混合型微指令</li>
</ul>
<p><strong>微程序控制单元的设计步骤</strong></p>
<p>主要任务是编写各条机器指令对应的微程序。具体步骤如下：</p>
<ul>
<li>写出对应机器指令的微操作命令及节拍安排</li>
<li>确定微指令格式</li>
<li>编写微指令码点</li>
</ul>
<p><strong>动态微程序涉及和毫微程序设计</strong></p>
<p><strong>硬布线和微程序控制器的特点</strong></p>
<h2 id="指令流水线"><a class="header" href="#指令流水线">指令流水线</a></h2>
<h3 id="基本概念"><a class="header" href="#基本概念">基本概念</a></h3>
<p>一种并行处理技术。一条指令的执行过程可分解为若干阶段，每个阶段由相应功能部件完成。如果将各个阶段视为相应流水段，则指令的执行过程就构成了一条指令流水线。采用流水线技术只需要增加少量硬件就能把计算机的运算速度提高几倍。</p>
<p>流水线执行方式</p>
<p>多级流水线</p>
<p><strong>指令流水的定义</strong></p>
<p>把一条指令的执行分为取指、分析、执行三个截断。当多条指令在处理器中执行时，可以采用以下两种方式：</p>
<ul>
<li>顺序执行方式：前一条指令执行完后才启动下一条指令，又称串行执行方式，控制简单但各部件利用率低。</li>
<li>流水线执行方式：为提高指令执行速度，把取k+1条执行提前到分析第k条指令的期间完成，将分析第k+1条指令与执行第k条指令同时进行。这种方式能将指令的执行时间缩短2/3，各功能部件利用率明显提高。但要付出硬件上较大的开销。理想状态下每个时钟周期都有一条指令进入流水线，处理机中同时有3条指令在执行，每条指令的时钟周期数CPI都为1。</li>
</ul>
<p>为了进一步获得更高的执行速度还可以将流水线进一步细分。划分为4级或者5级流水线。</p>
<p>流水线的设计原则：</p>
<ul>
<li>指令流水段个数以最复杂指令所用的功能段个数为准；</li>
<li>流水段的长度以最复杂操作所需的时间为准。</li>
</ul>
<p>流水线方式不一定能缩短一条指令的执行时间，但对于整个程序来说，可以大大增加指令执行的吞吐率。</p>
<p>为了利于实现指令流水线，指令集应具有以下特征：</p>
<ul>
<li>指令长度尽量一致，有利于简化取指令和指令译码操作</li>
<li>指令格式应尽量规整，尽量保证源寄存器的位置相同，有利于在指令未知时就可以取寄存器操作数。</li>
<li>采用Load/Store质量你个，其他指令都不能访问存储器，有利于减少操作步骤。</li>
<li>数据和指令在存储器中对其存放。有利于减少访存次数。</li>
</ul>
<p><strong>流水线的表示方法</strong></p>
<p>通常用时空图来直观描述流水线的工作过程。见书上的图所示。</p>
<p><strong>流水线方式的特点</strong></p>
<ul>
<li>把一个任务分解为几个有联系的子任务，每个子任务由一个专门的功能部件来执行，并依靠多个功能部件并行工作来缩短程序执行时间。</li>
<li>流水线的每个功能段后面都要有一个缓冲寄存器，用来保存本流水段的执行结果，供给下一流水段使用。</li>
<li>流水线中各功能段的时间应尽量相等，否则将引起堵塞、断流</li>
<li>只有连续不断提供同一种任务时才能发挥流水线的效率，所以流水线中处理的必须是连续任务。</li>
<li>流水线需要有装入时间和排空时间。</li>
</ul>
<h3 id="分类"><a class="header" href="#分类">分类</a></h3>
<p>按照不同的分类标准进行分：</p>
<p><strong>部件功能级、处理机级、处理机间级流水线</strong></p>
<ul>
<li>部件功能级：将复杂的算术逻辑运算组成流水线工作方式。</li>
<li>处理机级：把一条指令解释过程分成多个子过程，如前面提到的取值、译码、执行、访存和写回5个子过程</li>
<li>处理机间流水：一种宏流水，每个处理机完成某一专门任务。</li>
</ul>
<p><strong>单功能和多功能流水线</strong></p>
<p><strong>动态和静态流水线</strong></p>
<p>按同一时间段内各段之间的连接方式分。</p>
<p><strong>线性和非线性流水线</strong></p>
<p>按各个功能段之间是否有反馈信号。非线性流水线输入输出过程中多次通过某一段流水线，适合于线性递归运算。</p>
<h3 id="影响因素"><a class="header" href="#影响因素">影响因素</a></h3>
<p><strong>资源冲突</strong></p>
<p>多条指令在同一时刻争用同一资源形成的冲突。数据Cache和指令Cache分离的方式避免了资源冲突的发生。</p>
<p><strong>数据冲突</strong></p>
<p>下一条指令会用到当前指令计算出的结果。</p>
<ul>
<li>写后读</li>
<li>读后写</li>
<li>写后写</li>
</ul>
<p>解决方法：</p>
<ul>
<li>遇到数据相关的指令及其后序指令暂定一至几个时钟周期，知道相关问题消失后再执行。</li>
<li>设置相关专用通路，不等前一条指令把计算结果写入寄存器组，下一条指令也不再读寄存器组。</li>
<li>通过编译器对数据相关的指令编译优化的方法，调整指令顺序来解决数据相关。</li>
</ul>
<p><strong>控制冲突</strong></p>
<p>在执行转移、调用或返回等指令时会改变PC值，而造成断流，引起控制冒险。</p>
<p>解决方式：</p>
<ul>
<li>对指令进行分支预测，今早生成转移目标地址</li>
<li>预取转移成功和不成功两个控制流方向上的目标指令</li>
<li>加快和提前形成条件码</li>
<li>提高转移方向的猜准率</li>
</ul>
<h3 id="性能指标"><a class="header" href="#性能指标">性能指标</a></h3>
<p><strong>流水线的吞吐率</strong></p>
<p>单位时间内流水线所完成的任务数量，或输出结果的数量。</p>
<p><strong>流水线的加速比</strong></p>
<p>完成同一批任务，不使用流水线所用时间和使用流水线所用时间之比。</p>
<p><strong>流水线的效率</strong></p>
<p>流水线的设备利用率称为流水线的效率。</p>
<h3 id="超标量流水线"><a class="header" href="#超标量流水线">超标量流水线</a></h3>
<p><strong>超标量流水线技术</strong></p>
<p>每个时钟周期内可以并发多条独立指令，即以并行操作方式将两条或多条指令编译并执行，为此需要配置多个功能部件。</p>
<p>不能调整指令的执行顺序。</p>
<p><strong>超流水线技术</strong></p>
<p>一个时钟周期内再分段，在一个时钟周期内一个功能部件使用多次。</p>
<p><strong>超长指令字</strong></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../408_note/计算机组成原理/CH04-指令系统.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../../408_note/计算机组成原理/CH06-总线.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../408_note/计算机组成原理/CH04-指令系统.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../../408_note/计算机组成原理/CH06-总线.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
